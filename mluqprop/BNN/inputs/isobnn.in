#------------------------------------------
# Architecture
#------------------------------------------
# Model form for prior. Use either "isotropic" or "trainable". Only used for DenseVariational based BNN.
prior_model = "trainable"
# Model form for posterior. Use either "mvn" or "independent". Only used for DenseVariational based BNN.
posterior_model = "independent"
# Activation function (nonlinearity). Use either "relu", "tanh", or "sigmoid"
nonlin          = "sigmoid"
# Number of units in each hidden layer.
hidden_dim      = 10
# Number of hidden layers.
num_layers      = 3
# Which kind of Bayesian NN to train. Use either "epi" for epistemic uncertainty ONLY, or "variational" for a full Bayesian treatment (including aleatoric uncertainty), use "flipout" for a full Bayesian treatment with flipout layers.
model_type      = "variational"
# Whether or not to split the last layer of the BNN. Only for DenseVariational models.
split           = True
# Optional weighting of kl term. Value of -1 means that the KL term will be weighted by the number of data (proportional to ELBO)
klweight        = -1

#------------------------------------------
# Training
#------------------------------------------
# Maximum number of training iterations (epochs).
epochs          = 5000
# Number of epochs before early stopping kicks in.
patience        = 50
# Number of data to be included in each batch.
batch_size      = 4096
# Initial learning rate for scheduler.
learning_rate   = 1e-4
# Final learning rate for scheduler.
lrfinal         = 0.000000001
# Gradient norm to clip at
grad_clip       = 1e6
# Number of aleatoric realizations.
nalea           = 200
# Number of epistemic model realizations.
nepi            = 100

#------------------------------------------
# I/O
#------------------------------------------
# Filepath to dataset to be loaded.
data_fpath      = "/projects/mluq/mluq-prop/data/dns/Scaled_March16_KmeansOutput_AllCase.npz"
use_lean        = False
# Filepath to inducing points.
uips_fpath      = "/projects/mluq/frechet_uips_best_redo/frechetDistRef_100.npz"
# Filename for training history.
filename        = "cpu_full_trainable_prior"
# Where to save model results.
savedir         = "/projects/mluq/mluq-prop/models/experiments/cpu_full_trainable_prior"
# Path for checkpointing callback.
checkpath       = "/scratch/gpash/cpu_full_trainable_prior"
# How many epochs to optimize before reporting metrics
skip            = 10
